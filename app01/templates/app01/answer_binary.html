{% extends "app01/base.html" %}
{% load crispy_forms_tags %}
{% load highlight_keywords %}
{% load static %}

{% block content %}

    <div style="display: flex; align-items: baseline;">
        <h1 style="margin-right: 20px;">{{ question_tag }}</h1>
        <p>Current question tag status: <span id="question_tag_status" class="{{ question_tag.status|lower }}">{{ question_tag.status }}</span></p>
    </div>

    <div>
        <p>{{ user.userprofile.preferred_name }}, your current vote to approve or reject the question tag '{{ question_tag }}' for this project is:
            <span id="question_tag_user_vote" class="{{ question_tag_user_vote|lower }}">{{ question_tag_user_vote }}</span></p>
        <p>You can change your vote anytime using the link below.</p>

    <div style="display: flex; align-items: baseline;">
        <h2 style="margin-right: 20px;">{{ question_tag }} question:</h2>
        <p>Current question status: <span id="question_status" class="{{ question.status|lower }}">{{ question.status }}</span></p>
    </div>

    <div>
        <p>
            {% if question.question_text %}
                {{ question.question_text|highlight_keywords }}
            {% else %}
                "No question text available"
            {% endif %}
        </p>
    </div>

    <div>
        <p>{{ user.userprofile.preferred_name }}, your current vote to approve this '{{ question_tag }}' question is:
            <span id="question_user_vote" class="{{ question_user_vote|lower }}">{{ question_user_vote }}</span></p>
        <p>You can change your vote anytime using the link below.</p>


    <h2>Propose a new Question Tag and Question:</h2>
    <form method="post">
        {% csrf_token %}
        {{ question_form|crispy }}
        <input type="submit" class="propose-btn" name="question_submit" value="Propose">
    </form>
    {% if question_error %}
        <div class="alert alert-danger" role="alert">
            {{ question_error }}
        </div>
    {% endif %}
{% endblock %}

{% block extra_js %}
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <script>
        const voteUrl = "{% url 'app01:submit_vote' %}";
    </script>
    <script type="module" src="{% static 'app01/js/question_detail.js' %}"></script>
    <script type="module" src="{% static 'app01/js/binary_pie_chart.js' %}"></script>
{% endblock %}
